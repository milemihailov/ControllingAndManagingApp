@page "/bedlevel"
@inject Data.BedLevelingService bed

<div class="center-div">
<h1>BedLeveling</h1>
<script src='https://cdn.plot.ly/plotly-2.27.0.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
<div id='myDiv'><!-- Plotly chart will be drawn inside this DIV --></div>

<script type="text/javascript">
    d3.csv('@bed.CSVData', function (err, rows) {
        function unpack(rows, key) {
            return rows.map(function (row) { return row[key]; });
        }

        var z_data = []
        for (i = 0; i < 24; i++) {
            z_data.push(unpack(rows, i));
        }

        var data = [{
            z: z_data,
            type: 'surface'
        }];

        var layout = {
            title: 'Mt Bruno Elevation',
            autosize: false,
            width: 500,
            height: 500,
            margin: {
                l: 65,
                r: 50,
                b: 65,
                t: 90,
            }
        };
        Plotly.newPlot('myDiv', data, layout);
    });
</script>
<pre>@bed.CSVData</pre>
<button @onclick="() => bed.CalibrateBed()">Calibrate</button>
</div>
@code {

}
